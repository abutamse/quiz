<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz App</title>

<style>
body {
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(to bottom,#6a11cb,#2575fc);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  margin:0;
}
.container {
  background:white;
  width:95%;
  max-width:450px;
  padding:20px;
  border-radius:20px;
  box-shadow:0 10px 25px rgba(0,0,0,.3);
}
.hidden { display:none; }
h2,h3 { text-align:center; margin:10px 0; }

input, button {
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:10px;
  font-size:16px;
}
input { border:1px solid #ccc; }

button {
  border:none;
  background:#4CAF50;
  color:white;
  font-weight:bold;
  cursor:pointer;
}
button:hover { opacity:.9; }

.secondary { background:#2196F3; }
.danger { background:#f44336; }
.help { background:#FF9800; }

.block {
  background:#e2e8f0;
  padding:15px;
  border-radius:15px;
  margin-top:10px;
  cursor:pointer;
  text-align:center;
  font-weight:bold;
}
.block:hover { background:#d1d5db; }

.answer {
  background:#f1f5f9;
  color:black;
}
.answer:hover { background:#c7d2fe; }

.lang-bar button {
  width:auto;
  padding:5px 10px;
  margin:0 3px;
}

.coin {
  background:#ffecb3;
  padding:5px 10px;
  border-radius:10px;
  font-weight:bold;
}

[dir="rtl"] {
  direction: rtl;
  text-align: right;
}
</style>
</head>

<body>

<div class="container">

<!-- LOGIN -->
<div id="login">
  <h2 id="loginTitle"></h2>
  <input id="username">
  <input id="password" type="password">
  <button onclick="loginUser()" id="loginBtn"></button>
  <button class="secondary" onclick="registerUser()" id="registerBtn"></button>
  <p id="msg" style="color:red;text-align:center"></p>
</div>

<!-- APP -->
<div id="app" class="hidden">
  <div style="display:flex;justify-content:space-between;align-items:center">
    <h3 id="pageTitle"></h3>
    <div class="coin">ðŸ’° <span id="coins">0</span></div>
  </div>

  <div class="lang-bar">
    <button onclick="setLang('de')">DE</button>
    <button onclick="setLang('en')">EN</button>
    <button onclick="setLang('ar')">AR</button>
  </div>

  <div id="content"></div>

  <button class="danger" onclick="logout()" id="logoutBtn"></button>
</div>

</div>

<script>
// ===== STATE =====
let lang='en';
let user=null;
let helpUsed=false;
let current={topic:null,sub:null,q:0};

// ===== TRANSLATIONS =====
const UI = {
en:{login:"Login",register:"Register",user:"Username",pass:"Password",
topics:"Select Topic",back:"Back",logout:"Logout",help:"Help (100 coins)",
correct:"Correct!",wrong:"Wrong!",finished:"Quiz finished"},
de:{login:"Login",register:"Registrieren",user:"Benutzername",pass:"Passwort",
topics:"Thema wÃ¤hlen",back:"ZurÃ¼ck",logout:"Logout",help:"Hilfe (100 MÃ¼nzen)",
correct:"Richtig!",wrong:"Falsch!",finished:"Quiz beendet"},
ar:{login:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",register:"ØªØ³Ø¬ÙŠÙ„",user:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",pass:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
topics:"Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹",back:"Ø±Ø¬ÙˆØ¹",logout:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",help:"Ù…Ø³Ø§Ø¹Ø¯Ø© (100 Ø¹Ù…Ù„Ø©)",
correct:"ØµØ­ÙŠØ­!",wrong:"Ø®Ø·Ø£!",finished:"Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±"}
};

// ===== QUESTIONS =====
const DATA={
History:{
Europe:[
{q:{en:"When did WWII start?",de:"Wann begann der 2. Weltkrieg?",ar:"Ù…ØªÙ‰ Ø¨Ø¯Ø£Øª Ø§Ù„Ø­Ø±Ø¨ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ©ØŸ"},
a:["1939","1941","1918","1925"],c:0},
{q:{en:"Who was Napoleon?",de:"Wer war Napoleon?",ar:"Ù…Ù† ÙƒØ§Ù† Ù†Ø§Ø¨Ù„ÙŠÙˆÙ†ØŸ"},
a:["French leader","German king","Roman emperor","Spanish explorer"],c:0}
]},
Science:{
Physics:[
{q:{en:"Who developed relativity?",de:"Wer entwickelte die RelativitÃ¤tstheorie?",ar:"Ù…Ù† Ø·ÙˆØ± Ù†Ø¸Ø±ÙŠØ© Ø§Ù„Ù†Ø³Ø¨ÙŠØ©ØŸ"},
a:["Einstein","Newton","Tesla","Galileo"],c:0},
{q:{en:"Speed of light?",de:"Lichtgeschwindigkeit?",ar:"Ø³Ø±Ø¹Ø© Ø§Ù„Ø¶ÙˆØ¡ØŸ"},
a:["300,000 km/s","150,000 km/s","1,000 km/s","3,000 km/s"],c:0}
]},
Geography:{
World:[
{q:{en:"Largest ocean?",de:"GrÃ¶ÃŸter Ozean?",ar:"Ø£ÙƒØ¨Ø± Ù…Ø­ÙŠØ·ØŸ"},
a:["Pacific","Atlantic","Indian","Arctic"],c:0},
{q:{en:"Capital of Japan?",de:"Hauptstadt von Japan?",ar:"Ø¹Ø§ØµÙ…Ø© Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ØŸ"},
a:["Tokyo","Kyoto","Osaka","Beijing"],c:0}
]}
};

// ===== STORAGE =====
const getUser=u=>JSON.parse(localStorage.getItem("user_"+u));
const saveUser=(u,d)=>localStorage.setItem("user_"+u,JSON.stringify(d));

// ===== LANGUAGE =====
function setLang(l){
  lang=l;
  document.body.dir=(l==="ar"?"rtl":"ltr");
  renderLogin();
  renderTopics();
}

// ===== LOGIN =====
function renderLogin(){
  loginTitle.textContent=UI[lang].login;
  loginBtn.textContent=UI[lang].login;
  registerBtn.textContent=UI[lang].register;
  username.placeholder=UI[lang].user;
  password.placeholder=UI[lang].pass;
}
renderLogin();

function registerUser(){
  if(!username.value||!password.value) return;
  localStorage.setItem("user_"+username.value,JSON.stringify({pass:password.value,coins:0,done:{}}));
  loginUser();
}

function loginUser(){
  const d=getUser(username.value);
  if(!d||d.pass!==password.value){msg.textContent="Error";return;}
  user=username.value;
  login.classList.add("hidden");
  app.classList.remove("hidden");
  renderTopics();
}

// ===== TOPICS =====
function renderTopics(){
  pageTitle.textContent=UI[lang].topics;
  logoutBtn.textContent=UI[lang].logout;
  coins.textContent=getUser(user).coins;
  content.innerHTML="";
  for(const t in DATA){
    const div=document.createElement("div");
    div.className="block";
    div.textContent=t;
    div.onclick=()=>renderSubs(t);
    content.appendChild(div);
  }
}

// ===== SUBTOPICS =====
function renderSubs(t){
  current.topic=t;
  content.innerHTML="";
  for(const s in DATA[t]){
    const div=document.createElement("div");
    div.className="block";
    div.textContent=s;
    div.onclick=()=>startQuiz(s);
    content.appendChild(div);
  }
  backBtn();
}

// ===== QUIZ =====
function startQuiz(s){
  current.sub=s;
  current.q=0;
  showQuestion();
}

function showQuestion(){
  helpUsed=false;
  const quiz=DATA[current.topic][current.sub];
  if(current.q>=quiz.length){alert(UI[lang].finished);renderSubs(current.topic);return;}

  const q=quiz[current.q];
  content.innerHTML=`<h3>${q.q[lang]}</h3>`;

  q.a.forEach((txt,i)=>{
    const b=document.createElement("button");
    b.className="answer";
    b.textContent=txt;
    b.onclick=()=>checkAnswer(i);
    content.appendChild(b);
  });

  const help=document.createElement("button");
  help.className="help";
  help.textContent=UI[lang].help;
  help.onclick=useHelp;
  content.appendChild(help);

  backBtn();
}

function useHelp(){
  if(helpUsed) return;
  const u=getUser(user);
  if(u.coins<100) return;
  u.coins-=100;
  saveUser(user,u);
  coins.textContent=u.coins;

  const buttons=[...document.querySelectorAll(".answer")];
  const correct=DATA[current.topic][current.sub][current.q].c;
  const wrong=buttons.filter((_,i)=>i!==correct);
  wrong.sort(()=>0.5-Math.random()).slice(0,2).forEach(b=>b.style.display="none");
  helpUsed=true;
}

function checkAnswer(i){
  const u=getUser(user);
  const key=current.topic+current.sub+current.q;
  if(i===DATA[current.topic][current.sub][current.q].c){
    alert(UI[lang].correct);
    if(!u.done[key]){u.coins+=25;u.done[key]=1;}
    saveUser(user,u);
    coins.textContent=u.coins;
    current.q++;
    showQuestion();
  } else alert(UI[lang].wrong);
}

function backBtn(){
  const b=document.createElement("button");
  b.className="secondary";
  b.textContent=UI[lang].back;
  b.onclick=()=>renderSubs(current.topic);
  content.appendChild(b);
}

function logout(){location.reload();}
</script>

</body>
</html>
