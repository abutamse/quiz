<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Big Quiz</title>

<style>
body{
  font-family:'Segoe UI',Tahoma,sans-serif;
  margin:0;
  background:linear-gradient(to bottom,#6a11cb,#2575fc);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}
[dir="rtl"]{direction:rtl;text-align:right;}

.container{
  background:#fff;
  padding:20px;
  border-radius:20px;
  width:95%;
  max-width:600px;
  box-shadow:0 10px 25px rgba(0,0,0,0.3);
}
.hidden{display:none;}
h2,h3{text-align:center;}

button{
  width:100%;
  padding:12px;
  margin-top:10px;
  border:none;
  border-radius:10px;
  background:#4CAF50;
  color:white;
  font-weight:bold;
  cursor:pointer;
}

.theme,.sub,.answer{
  background:#4CAF50;
  color:white;
  padding:16px;
  margin:10px 0;
  border-radius:15px;
  text-align:center;
  cursor:pointer;
}

.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.badge{
  background:#ffecb3;
  padding:5px 10px;
  border-radius:10px;
  font-weight:bold;
}

.lang-btn{
  width:auto;
  padding:5px 10px;
  font-size:14px;
  background:#007BFF;
  margin:0 3px;
}

input{
  width:100%;
  padding:10px;
  margin-top:10px;
  border-radius:10px;
  border:1px solid #ccc;
  text-align:center;
}

.progress{
  width:100%;
  height:20px;
  background:#ddd;
  border-radius:10px;
  overflow:hidden;
}
.fill{
  height:100%;
  background:#4CAF50;
  width:0%;
}

#result{
  margin-top:10px;
  padding:10px;
  text-align:center;
  font-weight:bold;
  border-radius:10px;
  display:none;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="container" id="loginBox">
  <h2 id="loginTitle">Login / Registrierung</h2>
  <input id="username" placeholder="Benutzername">
  <input id="password" type="password" placeholder="Passwort">
  <button onclick="login()">Login</button>
  <button onclick="login()">Registrieren</button>
</div>

<!-- THEMEN -->
<div class="container hidden" id="themeBox">
  <div class="top">
    <h2 id="themeTitle"></h2>
    <div class="badge">üí∞ <span id="coins">0</span> | ‚≠ê <span id="level">1</span></div>
  </div>

  <div>
    <button class="lang-btn" onclick="setLang('de')">DE</button>
    <button class="lang-btn" onclick="setLang('en')">EN</button>
    <button class="lang-btn" onclick="setLang('ar')">AR</button>
  </div>

  <div id="themes"></div>
  <button style="background:#f44336" onclick="logout()">Logout</button>
</div>

<!-- QUIZ -->
<div class="container hidden" id="quizBox">
  <div class="top">
    <h3 id="quizTitle"></h3>
    <div class="badge">üí∞ <span id="quizCoins">0</span></div>
  </div>

  <div class="progress"><div class="fill" id="fill"></div></div>

  <div id="question"></div>
  <div id="answers"></div>

  <button id="helpBtn" style="background:#ff9800" onclick="useHelp()">
    Hilfe (100 üí∞)
  </button>

  <div id="result"></div>

  <button style="background:#f44336" onclick="backToSub()">‚¨Ö Zur√ºck</button>
</div>

<script>
// ================= QUIZDATEN =================
const quizData={
  Geschichte:{
    label:{de:"Geschichte",en:"History",ar:"ÿßŸÑÿ™ÿßÿ±ŸäÿÆ"},
    Deutschland:{
      label:{de:"Deutschland",en:"Germany",ar:"ÿ£ŸÑŸÖÿßŸÜŸäÿß"},
      questions:[
        {
          q:{de:"Wann begann der 2. Weltkrieg?",en:"When did WWII start?",ar:"ŸÖÿ™Ÿâ ÿ®ÿØÿ£ÿ™ ÿßŸÑÿ≠ÿ±ÿ® ÿßŸÑÿπÿßŸÑŸÖŸäÿ© ÿßŸÑÿ´ÿßŸÜŸäÿ©ÿü"},
          options:{
            de:["1939","1945","1914","1923"],
            en:["1939","1945","1914","1923"],
            ar:["1939","1945","1914","1923"]
          },
          answer:{de:"1939",en:"1939",ar:"1939"}
        }
      ]
    }
  },
  TextQuiz:{
    label:{de:"Text Quiz",en:"Text Quiz",ar:"ÿßÿÆÿ™ÿ®ÿßÿ± ŸÜÿµŸä"},
    R√§tsel:{
      label:{de:"R√§tsel",en:"Riddle",ar:"ŸÑÿ∫ÿ≤"},
      questions:[
        {
          q:{de:"Ein Tier, das miaut",en:"An animal that meows",ar:"ÿ≠ŸäŸàÿßŸÜ ŸäÿµÿØÿ± ŸÖŸàÿßÿ°"},
          answer:{de:"Katze",en:"Cat",ar:"ŸÇÿ∑ÿ©"}
        }
      ]
    }
  }
};

// ================= STATE =================
let lang="de",topic,sub,index=0;
let coins=+localStorage.getItem("coins")||0;
let level=+localStorage.getItem("level")||1;
let reducedOptions=null;

// ================= UTIL =================
const shuffle=a=>[...a].sort(()=>Math.random()-0.5);

// ================= SPRACHE =================
function setLang(l){
  lang=l;
  document.documentElement.dir=l==="ar"?"rtl":"ltr";
  renderThemes();
}

// ================= LOGIN =================
function login(){
  loginBox.classList.add("hidden");
  themeBox.classList.remove("hidden");
  renderThemes();
}
function logout(){
  themeBox.classList.add("hidden");
  loginBox.classList.remove("hidden");
}

// ================= THEMEN =================
function renderThemes(){
  themes.innerHTML="";
  themeTitle.textContent=
    lang==="de"?"Themen ausw√§hlen":
    lang==="en"?"Select topics":"ÿßÿÆÿ™ÿ± ÿßŸÑŸÖŸàÿ∂Ÿàÿπ";

  Object.keys(quizData).forEach(t=>{
    const d=document.createElement("div");
    d.className="theme";
    d.textContent=quizData[t].label[lang];
    d.onclick=()=>renderSubs(t);
    themes.appendChild(d);
  });
  updateStats();
}

// ================= SUB =================
function renderSubs(t){
  topic=t;
  themes.innerHTML="";
  Object.keys(quizData[t]).forEach(s=>{
    if(s==="label")return;
    const d=document.createElement("div");
    d.className="sub";
    d.textContent=quizData[t][s].label[lang];
    d.onclick=()=>startQuiz(s);
    themes.appendChild(d);
  });
  const back=document.createElement("button");
  back.textContent="‚¨Ö Zur√ºck";
  back.style.background="#f44336";
  back.onclick=renderThemes;
  themes.appendChild(back);
}

// ================= QUIZ =================
function startQuiz(s){
  sub=s; index=0; reducedOptions=null;
  themeBox.classList.add("hidden");
  quizBox.classList.remove("hidden");
  showQuestion();
}

function showQuestion(){
  const q=quizData[topic][sub].questions[index];
  if(!q){ backToSub(); return; }

  quizTitle.textContent=quizData[topic][sub].label[lang];
  question.textContent=q.q[lang];
  answers.innerHTML="";
  helpBtn.style.display="block";

  if(q.options){
    const opts=reducedOptions||shuffle(q.options[lang]);
    opts.forEach(o=>{
      const b=document.createElement("button");
      b.className="answer";
      b.textContent=o;
      b.onclick=()=>check(o);
      answers.appendChild(b);
    });
  }else{
    const i=document.createElement("input");
    i.id="textAnswer";
    answers.appendChild(i);
    const b=document.createElement("button");
    b.textContent=lang==="de"?"Antworten":"Submit";
    b.onclick=()=>checkText(i.value);
    answers.appendChild(b);
  }

  quizCoins.textContent=coins;
  fill.style.width=(index/quizData[topic][sub].questions.length*100)+"%";
}

// ================= HILFE =================
function useHelp(){
  if(coins<100)return alert("Nicht genug Coins!");
  coins-=100; updateStats();

  const q=quizData[topic][sub].questions[index];
  if(q.options){
    const wrong=q.options[lang].filter(o=>o!==q.answer[lang]);
    reducedOptions=shuffle([q.answer[lang],wrong[0]]);
    showQuestion();
  }else{
    document.getElementById("textAnswer").value=q.answer[lang].slice(0,2);
  }
}

// ================= CHECK =================
function check(ans){
  const q=quizData[topic][sub].questions[index];
  showResult(ans===q.answer[lang]);
}
function checkText(ans){
  const q=quizData[topic][sub].questions[index];
  showResult(ans.trim().toLowerCase()===q.answer[lang].toLowerCase());
}

function showResult(correct){
  if(correct){
    coins+=25;
    if(coins>=level*100)level++;
    result.textContent=lang==="de"?"Richtig!":"Correct!";
    result.style.background="#4CAF50";
  }else{
    result.textContent=lang==="de"?"Falsch!":"Wrong!";
    result.style.background="#f44336";
  }
  save(); updateStats();
  result.style.display="block";
  reducedOptions=null;
  index++;
  setTimeout(()=>{result.style.display="none";showQuestion();},1000);
}

// ================= BACK =================
function backToSub(){
  quizBox.classList.add("hidden");
  themeBox.classList.remove("hidden");
  renderSubs(topic);
}

// ================= STATS =================
function updateStats(){
  coinsSpan.textContent=coins;
  quizCoins.textContent=coins;
  levelSpan.textContent=level;
}
function save(){
  localStorage.setItem("coins",coins);
  localStorage.setItem("level",level);
}
</script>

</body>
</html>
