<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Big Quiz</title>
<style>
body{
  font-family:'Segoe UI',Tahoma,sans-serif;
  margin:0;
  background:linear-gradient(to bottom,#6a11cb,#2575fc);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}
[dir="rtl"]{direction:rtl;text-align:right;}
.container{
  background:#fff;
  padding:20px;
  border-radius:20px;
  width:95%;
  max-width:600px;
  box-shadow:0 10px 25px rgba(0,0,0,0.3);
}
.hidden{display:none;}
h2,h3{text-align:center;}
button{
  width:100%;
  padding:12px;
  margin-top:10px;
  border:none;
  border-radius:10px;
  background:#4CAF50;
  color:white;
  font-weight:bold;
  cursor:pointer;
}
.theme,.sub,.answer{
  background:#4CAF50;
  color:white;
  padding:16px;
  margin:10px 0;
  border-radius:15px;
  text-align:center;
  cursor:pointer;
}
.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.badge{
  background:#ffecb3;
  padding:5px 10px;
  border-radius:10px;
  font-weight:bold;
}
.lang-btn{
  width:auto;
  padding:5px 10px;
  font-size:14px;
  background:#007BFF;
  margin:0 3px;
  color:white;
  border:none;
  border-radius:5px;
  cursor:pointer;
}
.progress{
  width:100%;
  height:20px;
  background:#ddd;
  border-radius:10px;
  overflow:hidden;
}
.fill{height:100%;background:#4CAF50;width:0%;}
#result{
  margin-top:10px;
  padding:10px;
  border-radius:10px;
  font-weight:bold;
  text-align:center;
  display:none;
}
input{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #ccc;
  text-align:center;
}
</style>
</head>
<body>

<!-- LOGIN -->
<div class="container" id="loginBox">
  <h2 id="loginTitle">Login / Registrierung</h2>
  <input id="username" placeholder="Benutzername">
  <input id="password" type="password" placeholder="Passwort">
  <button onclick="login()" id="loginBtn">Login</button>
  <button onclick="register()" id="registerBtn">Registrieren</button>
  <p id="loginMsg" style="color:red;text-align:center;"></p>
</div>

<!-- THEMEN -->
<div class="container hidden" id="themeBox">
  <div class="top">
    <h2 id="themeTitle"></h2>
    <div class="badge">üí∞ <span id="coinsSpan">0</span> | ‚≠ê <span id="levelSpan">1</span></div>
  </div>

  <div>
    <button class="lang-btn" onclick="setLang('de')">DE</button>
    <button class="lang-btn" onclick="setLang('en')">EN</button>
    <button class="lang-btn" onclick="setLang('ar')">AR</button>
  </div>

  <div id="themes"></div>
  <button style="background:#f44336;margin-top:10px;" onclick="logout()">Logout</button>
</div>

<!-- QUIZ -->
<div class="container hidden" id="quizBox">
  <div class="top">
    <h3 id="quizTitle"></h3>
    <div class="badge">üí∞ <span id="quizCoins">0</span></div>
  </div>

  <div class="progress"><div class="fill" id="fill"></div></div>

  <div id="question"></div>
  <div id="answers"></div>

  <button style="background:#ff9800" onclick="useHelp()">Hilfe (100 üí∞)</button>

  <div id="result"></div>

  <button style="background:#f44336" onclick="backToThemes()">‚¨Ö Zur√ºck</button>
</div>

<script>
/* ================= DATA ================= */
const quizData={
  Geschichte:{
    label:{de:"Geschichte",en:"History",ar:"ÿßŸÑÿ™ÿßÿ±ŸäÿÆ"},
    Deutschland:{
      label:{de:"Deutschland",en:"Germany",ar:"ÿ£ŸÑŸÖÿßŸÜŸäÿß"},
      questions:[
        {
          q:{de:"Wann begann der 2. Weltkrieg?",en:"When did WWII start?",ar:"ŸÖÿ™Ÿâ ÿ®ÿØÿ£ÿ™ ÿßŸÑÿ≠ÿ±ÿ® ÿßŸÑÿπÿßŸÑŸÖŸäÿ© ÿßŸÑÿ´ÿßŸÜŸäÿ©ÿü"},
          options:{de:["1939","1945","1914","1923"],en:["1939","1945","1914","1923"],ar:["1939","1945","1914","1923"]},
          answer:{de:"1939",en:"1939",ar:"1939"}
        }
      ]
    }
  },
  Allgemein:{
    label:{de:"Allgemein",en:"General",ar:"ÿπÿßŸÖ"},
    Geographie:{
      label:{de:"Geographie",en:"Geography",ar:"ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸäÿß"},
      questions:[
        {
          q:{de:"Was ist die Hauptstadt von Deutschland?",en:"What is the capital of Germany?",ar:"ŸÖÿß ŸáŸä ÿπÿßÿµŸÖÿ© ÿ£ŸÑŸÖÿßŸÜŸäÿßÿü"},
          options:{de:["Berlin","M√ºnchen","Hamburg","Frankfurt"],en:["Berlin","Munich","Hamburg","Frankfurt"],ar:["ÿ®ÿ±ŸÑŸäŸÜ","ŸÖŸäŸàŸÜŸäÿÆ","ŸáÿßŸÖÿ®Ÿàÿ±ÿ∫","ŸÅÿ±ÿßŸÜŸÉŸÅŸàÿ±ÿ™"]},
          answer:{de:"Berlin",en:"Berlin",ar:"ÿ®ÿ±ŸÑŸäŸÜ"}
        }
      ]
    },
    R√§tsel:{
      label:{de:"R√§tsel",en:"Riddle",ar:"ŸÑÿ∫ÿ≤"},
      questions:[
        {
          q:{de:"Etwas, das umso gr√∂√üer wird, je mehr man davon nimmt",en:"Something that grows the more you take from it",ar:"ÿ¥Ÿäÿ° ŸäŸÉÿ®ÿ± ŸÉŸÑŸÖÿß ÿ£ÿÆÿ∞ÿ™ ŸÖŸÜŸá ÿ£ŸÉÿ´ÿ±"},
          answer:{de:"Grube",en:"Hole",ar:"ÿ≠ŸÅÿ±ÿ©"}
        }
      ]
    }
  },
  TextQuiz:{
    label:{de:"Text Quiz",en:"Text Quiz",ar:"ÿßÿÆÿ™ÿ®ÿßÿ± ŸÜÿµŸä"},
    R√§tsel:{
      label:{de:"R√§tsel",en:"Riddle",ar:"ŸÑÿ∫ÿ≤"},
      questions:[
        {
          q:{de:"Ein Tier, das miaut",en:"An animal that meows",ar:"ÿ≠ŸäŸàÿßŸÜ ŸäÿµÿØÿ± ŸÖŸàÿßÿ°"},
          answer:{de:"Katze",en:"Cat",ar:"ŸÇÿ∑ÿ©"}
        }
      ]
    }
  }
};

/* ================= STATE ================= */
let lang="de";
let topic=null, sub=null, index=0;
let coins=Number(localStorage.getItem("coins"))||0;
let level=Number(localStorage.getItem("level"))||1;
let reduced=null;

/* ================= UTIL ================= */
const shuffle=a=>[...a].sort(()=>Math.random()-0.5);

/* ================= LOGIN ================= */
function login(){
  const u=document.getElementById("username").value.trim();
  const p=document.getElementById("password").value;
  if(!u || !p){document.getElementById("loginMsg").textContent=lang==="de"?"Bitte ausf√ºllen":"Please fill in"; return;}
  localStorage.setItem("currentUser",u);
  loginBox.classList.add("hidden");
  themeBox.classList.remove("hidden");
  renderThemes();
}

function register(){
  const u=document.getElementById("username").value.trim();
  const p=document.getElementById("password").value;
  if(!u || !p){document.getElementById("loginMsg").textContent=lang==="de"?"Bitte ausf√ºllen":"Please fill in"; return;}
  localStorage.setItem("currentUser",u);
  document.getElementById("loginMsg").textContent=lang==="de"?"Registriert!":"Registered!";
}

/* ================= LANGUAGE ================= */
function setLang(l){
  lang=l;
  document.documentElement.dir=l==="ar"?"rtl":"ltr";
  renderThemes();
}

/* ================= THEMES ================= */
function renderThemes(){
  document.getElementById("themes").innerHTML="";
  document.getElementById("themeTitle").textContent=
    lang==="de"?"Themen ausw√§hlen":lang==="en"?"Select topics":"ÿßÿÆÿ™ÿ± ÿßŸÑŸÖŸàÿ∂Ÿàÿπ";

  for(const t in quizData){
    const d=document.createElement("div");
    d.className="theme";
    d.textContent=quizData[t].label[lang];
    d.onclick=()=>renderSubs(t);
    document.getElementById("themes").appendChild(d);
  }
  updateStats();
}

function renderSubs(t){
  topic=t;
  const container=document.getElementById("themes");
  container.innerHTML="";
  for(const s in quizData[t]){
    if(s==="label") continue;
    const d=document.createElement("div");
    d.className="sub";
    d.textContent=quizData[t][s].label[lang];
    d.onclick=()=>startQuiz(s);
    container.appendChild(d);
  }
  const backBtn=document.createElement("button");
  backBtn.textContent=lang==="de"?"‚¨Ö Zur√ºck":lang==="en"?"‚¨Ö Back":"‚¨Ö ÿßŸÑÿπŸàÿØÿ©";
  backBtn.style.background="#f44336";
  backBtn.onclick=renderThemes;
  container.appendChild(backBtn);
}

/* ================= QUIZ ================= */
function startQuiz(s){
  sub=s; index=0; reduced=null;
  themeBox.classList.add("hidden");
  quizBox.classList.remove("hidden");
  showQuestion();
}

function showQuestion(){
  const q=quizData[topic][sub].questions[index];
  if(!q){ backToThemes(); return; }

  document.getElementById("quizTitle").textContent=quizData[topic][sub].label[lang];
  document.getElementById("question").textContent=q.q[lang];
  document.getElementById("answers").innerHTML="";
  document.getElementById("quizCoins").textContent=coins;

  if(q.options){
    const opts=shuffle(reduced||q.options[lang]);
    opts.forEach(o=>{
      const b=document.createElement("button");
      b.className="answer";
      b.textContent=o;
      b.onclick=()=>check(o);
      document.getElementById("answers").appendChild(b);
    });
  }else{
    const i=document.createElement("input"); i.id="textAnswer";
    document.getElementById("answers").appendChild(i);
    const b=document.createElement("button");
    b.textContent=lang==="de"?"Antworten":lang==="en"?"Submit":"ÿ•ÿ±ÿ≥ÿßŸÑ";
    b.onclick=()=>checkText(i.value);
    document.getElementById("answers").appendChild(b);
  }

  document.getElementById("fill").style.width=(index/quizData[topic][sub].questions.length*100)+"%";
}

/* ================= HELP ================= */
function useHelp(){
  if(coins<100){alert(lang==="de"?"Nicht genug Coins!":"Not enough coins!"); return;}
  coins-=100; updateStats();

  const q=quizData[topic][sub].questions[index];
  if(q.options){
    const wrong=q.options[lang].filter(o=>o!==q.answer[lang]);
    reduced=shuffle([q.answer[lang],wrong[0]]);
    showQuestion();
  }else{
    const input=document.getElementById("textAnswer");
    if(input) input.value=q.answer[lang].substring(0,2);
  }
}

/* ================= CHECK ================= */
function check(ans){
  const q=quizData[topic][sub].questions[index];
  showResult(ans===q.answer[lang]);
}
function checkText(ans){
  const q=quizData[topic][sub].questions[index];
  showResult(ans.trim().toLowerCase()===q.answer[lang].toLowerCase());
}

function showResult(correct){
  const res=document.getElementById("result");
  if(correct){
    coins+=25;
    if(coins>=level*100) level++;
    res.textContent=lang==="de"?"Richtig!":lang==="en"?"Correct!":"ÿµÿ≠Ÿäÿ≠!";
    res.style.background="#4CAF50";
  }else{
    res.textContent=lang==="de"?"Falsch!":lang==="en"?"Wrong!":"ÿÆÿ∑ÿ£!";
    res.style.background="#f44336";
  }
  localStorage.setItem("coins",coins);
  localStorage.setItem("level",level);
  res.style.display="block";
  reduced=null;
  index++;
  setTimeout(()=>{res.style.display="none"; showQuestion();},1000);
}

/* ================= BACK ================= */
function backToThemes(){
  quizBox.classList.add("hidden");
  themeBox.classList.remove("hidden");
  renderThemes();
}

/* ================= STATS ================= */
function updateStats(){
  document.getElementById("coinsSpan").textContent=coins;
  document.getElementById("levelSpan").textContent=level;
}

/* ================= LOGOUT ================= */
function logout(){
  localStorage.removeItem("currentUser");
  loginBox.classList.remove("hidden");
  themeBox.classList.add("hidden");
}
</script>
</body>
</html>
